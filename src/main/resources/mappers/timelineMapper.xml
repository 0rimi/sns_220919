<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="com.sns.timeline.dao.TimelineDAO">
	
	<!-- 포스트 업로드 : insert -->
	<insert id="insertPost" parameterType="map">
		INSERT INTO `post`
		(
			`userId`
			,`content`
			,`imgPath`
			,`createdAt`
			,`updatedAt`
		)
		VALUES
		(
			#{userId}
			,#{content}
			,#{imgPath}
			,NOW()
			,NOW()
		)
	</insert>
	
	<!-- 포스트 리스트 : select -->
	<select id="selectPosts" resultType="com.sns.timeline.model.Post">
		SELECT
			p.id as id,
			p.userId as userId,
			p.content as content,
			p.imgPath as imgPath,
			p.createdAt as createdAt,
			p.updatedAt as updatedAt,
			u.name as name,
    		u.profileUrl as profileUrl
		FROM `post` AS p
		INNER JOIN `user` AS u
		WHERE u.id = p.userId
		ORDER BY p.createdAt DESC
	</select>
	
</mapper>
